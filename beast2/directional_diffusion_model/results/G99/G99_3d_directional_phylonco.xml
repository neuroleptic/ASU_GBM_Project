<?xml version="1.0" ?>
<beast version="2.7" namespace="beast.base.core:beast.base.inference:beast.base.evolution.alignment:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.base.evolution.branchratemodel:beastclassic.continuous:beastclassic.evolution.tree:beastclassic.math.distributions:beastclassic.evolution.operators:phylonco.beast.evolution.errormodel:phylonco.beast.evolution.substitutionmodel:phylonco.beast.evolution.likelihood:beast.base.evolution.datatype:beast3d.directional.likelihood:beast3d.directional.model:beast3d.directional.operators">
    <alignment id="G99_mutations" spec="Alignment" dataType="binary">
        <sequence id="seq_Clone1" spec="Sequence" taxon="Clone1" value="1100011111101101111101110101111011010101111110111011111111111111110111011110001111111010111010110100111111101110011110101111000111011101110101111111111111011010111111001100100010110101001111111111101001101111101111111111111011110110100001101111110111011111111110010001010111110111110101000110100101111011111001111110101111111111101111100010111010111111111111111111111111101111001111010011010111111111111110111010101111110101011101100101111101100111111101111011111001011101101000110011011110110011111111110101011110111011110010011100111011111011111101001110111001000110110011101111011011011111011111101101111001101111111111111111111101110111011101111111011110011111111111001011010111111011101111111111111111111011111011100011111111111110110111011101111111101111111000111110111111111111111011011111110101101111111111001100111111101110111111101111111111010111111011011110111111011010111111110111111101010100011111111110111001111111111011111101101110011111011111100101011101111011111011110101111111111111"/>
        <sequence id="seq_Clone2" spec="Sequence" taxon="Clone2" value="1100011111101101111101110101111011010101111110111011111111111111110111011110001111111010111010110100111111101110011110101111100111011101110101111111111111011010111111001100100010110101001111111111111001101111101111111111111011110110100001101111110111011111111110010001010111111111110101000110100101111011111001111110101111111111101111100010111010111111111111111111111111101111001111010011010111111111111110111011111111110101011101100101111101100111111101111011111101011101101000110011011110110011111111110101011110111011110010011100111011111011111101001110111001000110110011101111011011011111011111101101111001101111111111111111111101110111011101111111011110011111111111011011010111111011101111111111111111111011111011100011111111111110110111011101111111101111111001111110111111111111111011011111110101101111111111001100111111101110111111101111111111010111111011011110111111011110111111110111111101010100011111111110111001111111111011111101101110011111011111100101011111111011111011110101111111111111"/>
        <sequence id="seq_Clone3" spec="Sequence" taxon="Clone3" value="1110011111111101111101111101111111111111111110111111111111111111110111011110111111111111111110111111111111111111111110101111010111111111111101111111111111111111111111011111111011111111111111111111101001101111101111111111111111110110101011111111111111111111111110111011011111110111111111101111111101111111111101111111101111111111101111101110111110111111111111111111111111101111101111011011111111111111111110111010101111111111011101101111111111111111111111111111111011011101111111110111111110110111111111111111111110111111111111111100111111111011111101011110111001010111111111101111011111111111111111111101111101101111111111111111111111110111111111111111111110011111111111001011111111111111111111111111111111111011111111110111111111111111111111011111111111101111111110111111111111111111111111011111111111101111111111111111111111101111111111101111111111010111111111111110111111011011111111110111111111110101111111111111111011111111111111111101111111111111011111100101011101111111111011111111111111111111"/>
        <sequence id="seq_Clone4" spec="Sequence" taxon="Clone4" value="1111011111111101111101111101111111111111111110111111111111111111110111011110111111111111111110111111111111111111111110101111010111111111111101111111111111111111111111011111111111111111111111111111101101111111101111111111111111110110101011111111111111111111111110111011011111110111111111101111111101111111111101111111101111111111101111111110111110111111111111111111111111111111101111011011111111111111111110111110101111111111011101101111111111111111111111111111111011011101111111111111111110110111111111111111111111111111111111111100111111111111111101011110111011110111111111101111111111111111111111111111111101101111111111111111111111110111111111111111111110011111111111101011111111111111111111111111111111111011111111110111111111111111111111111111111111101111111110111111111111111111111111011111111111101111111111111111111111101111111111101111111111011111111111111110111111111011111111110111111111110101111111111111111011111111111111111101111111111111011111110111011101111111111011111111111111111111"/>
        <sequence id="seq_Clone5" spec="Sequence" taxon="Clone5" value="1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"/>
        <sequence id="seq_Clone6" spec="Sequence" taxon="Clone6" value="1110011111111101111101111111111111111111111111111111111111111111110111011110111111111101111110111111111111111111111111101111011111111111111101101111111111111111111111011111111011111111111111111111111001101111101111111111111111110110101111111111111111111111111110111011011111111111111111101111111111111111111101111111111111111111101111101111111110111111111111111111111111101111111111011011111111111111111110111011111111111111011101101111111111111111111111111111111111011101111111110111111110110111111111111111111110111111111111111100111111111011111111011111111001011111111111101111011111111111111111111101111101101111111111111111111111111111111111111111111110010111111111001011111111111111111111111111111111111011111111111111111111111111111111011111111111101111111110111111111111111111111111011111111111101111101111111111111111111111111111101111111111010111111111111110111111011111111111111111111111110101111111111111111011111101111111111111111111111111011111100101011111111111111011111111111111111111"/>
    </alignment>
    
    <dataType id="binaryDataType" spec="beast.base.evolution.datatype.Binary"/>
    
    <!-- 3D coordinates -->
    <parameter id="trait.3d" spec="beast.base.inference.parameter.RealParameter"
               dimension="18" name="stateNode" lower="-100.0" upper="100.0">
        119.0 98.0 22.0 119.0 98.0 22.0 121.0 106.0 24.0 121.0 106.0 24.0 126.0 109.0 21.0 122.0 109.0 21.0
    </parameter>
    
    <!-- Precision matrix -->
    <parameter id="precision.3d" spec="beast.base.inference.parameter.RealParameter"
               dimension="3" name="stateNode" lower="0.01" upper="100.0">
        1.0 1.0 1.0
    </parameter>
    
    <!-- DIRECTIONAL DRIFT PARAMETERS -->
    <parameter id="drift.rate" spec="beast.base.inference.parameter.RealParameter"
               dimension="3" name="stateNode" lower="-10.0" upper="10.0">
        0.001 0.001 0.001
    </parameter>
    
    <!-- Diffusion rate -->
    <parameter id="diffusion.rate" spec="beast.base.inference.parameter.RealParameter"
               name="stateNode" lower="0.1" upper="10.0">
        0.5
    </parameter>
    
    <!-- Location parameter for compatibility -->
    <parameter id="location" spec="beast.base.inference.parameter.RealParameter"
               dimension="18" estimate="false">
        119 98 22 119 98 22 121 106 24 121 106 24 126 109 21 122 109 21
    </parameter>
    
    <traitmap id="traitmap" spec="beastclassic.evolution.tree.TreeTraitMap" tree="@Tree.t:G99" parameter="@location" traitName="location" randomizeupper="50 50 50" randomizelower="-50 -50 -50">
		Clone1=119.00 98.00 22.00,		Clone2=119.00 98.00 22.00,		Clone3=121.00 106.00 24.00,		Clone4=121.00 106.00 24.00,		Clone5=126.00 109.00 21.00,		Clone6=122.00 109.00 21.00
    </traitmap>
    
    <distribution id="rootPrior" spec='beastclassic.math.distributions.MultivariateNormalDistribution'>
        <arg id='rootTrait' spec='beastclassic.evolution.tree.RootTrait' traitmap='@traitmap'/>
        <mean spec='beast.base.inference.parameter.RealParameter' value='0.0 0.0 0.0'/>
        <precision spec='beast.base.inference.parameter.RealParameter' minordimension='3'>
            0.001 0.0 0.0
            0.0 0.001 0.0
            0.0 0.0 0.001
        </precision>
    </distribution>
    
    <!-- Mutation rate -->
    <parameter id="lambda" spec="beast.base.inference.parameter.RealParameter" lower="0.0" value="2.0"/>
    
    <!-- PhyloNCO error model parameters -->
    <parameter id="alpha" spec="beast.base.inference.parameter.RealParameter" lower="0.0" upper="1.0" value="0.01"/>
    <parameter id="beta" spec="beast.base.inference.parameter.RealParameter" lower="0.0" upper="1.0" value="0.05"/>
    
    <!-- Clock parameters -->
    <parameter id="clockRate" spec="beast.base.inference.parameter.RealParameter" lower="0.0" value="1.0"/>
    <parameter id="popSize" spec="beast.base.inference.parameter.RealParameter" lower="0.0" value="0.5"/>
    
    <map name="Beta">beast.base.inference.distribution.Beta</map>
    <map name="Exponential">beast.base.inference.distribution.Exponential</map>
    <map name="InverseGamma">beast.base.inference.distribution.InverseGamma</map>
    <map name="LogNormal">beast.base.inference.distribution.LogNormalDistributionModel</map>
    <map name="Prior">beast.base.inference.distribution.Prior</map>
    <map name="Gamma">beast.base.inference.distribution.Gamma</map>
    <map name="Uniform">beast.base.inference.distribution.Uniform</map>
    <map name="LaplaceDistribution">beast.base.inference.distribution.LaplaceDistribution</map>
    <map name="OneOnX">beast.base.inference.distribution.OneOnX</map>
    <map name="Normal">beast.base.inference.distribution.Normal</map>
    
    <run id="mcmc" spec="MCMC" chainLength="10000000">
        <state id="state" spec="State" storeEvery="1000">
            <tree id="Tree.t:G99" name="stateNode">
                <trait id="dateTrait.t:G99" spec="beast.base.evolution.tree.TraitSet" traitname="date">
                        Clone1=2003.4,
                        Clone2=2003.4,
                        Clone3=2003.4,
                        Clone4=2003.4,
                        Clone5=2003.4,
                        Clone6=2003.4
                    <taxa id="TaxonSet.G99" spec="TaxonSet">
                        <data idref="G99_mutations" name="alignment"/>
                    </taxa>
                </trait>
                <taxonset idref="TaxonSet.G99"/>
            </tree>
            
            <stateNode idref='trait.3d'/>
            <stateNode idref='precision.3d'/>
            <stateNode idref='drift.rate'/>
            <stateNode idref='diffusion.rate'/>
            <stateNode idref='clockRate'/>
            <stateNode idref='popSize'/>
            <stateNode idref='lambda'/>
            <stateNode idref='alpha'/>
            <stateNode idref='beta'/>
        </state>
        
        <distribution id="posterior" spec="beast.base.inference.CompoundDistribution">
            <distribution id="prior" spec="beast.base.inference.CompoundDistribution">
                <distribution id="CoalescentConstant.t:G99" spec="Coalescent">
                    <populationModel id="ConstantPopulation.t:G99" popSize="@popSize" spec="ConstantPopulation"/>
                    <treeIntervals id="TreeIntervals.t:G99" spec="beast.base.evolution.tree.TreeIntervals" tree="@Tree.t:G99"/>
                </distribution>
                <Prior id="ClockPrior" name="distribution" x="@clockRate">
                    <Uniform id="Uniform.0" name="distr"/>
                </Prior>
                <Prior id="PopSizePrior" name="distribution" x="@popSize">
                    <OneOnX id="OneOnX.0" name="distr"/>
                </Prior>
                <Prior id="LambdaPrior" name="distribution" x="@lambda">
                    <Exponential id="Exponential.1" name="distr" mean="2.0"/>
                </Prior>
                
                <distribution idref='rootPrior'/>
                
                <!-- Directional drift priors -->
                <Prior id="DriftRatePrior" name="distribution" x="@drift.rate">
                    <Normal id="NormalDist.0" name="distr" mean="0.0" sigma="5.0"/>
                </Prior>
                <Prior id="DiffusionRatePrior" name="distribution" x="@diffusion.rate">
                    <LogNormal id="LogNormalDist.0" name="distr" M="0.0" S="1.0"/>
                </Prior>
                <!-- PhyloNCO priors -->
                <Prior id="AlphaPrior" name="distribution" x="@alpha">
                    <Beta id="BetaDist.0" name="distr" alpha="1.0" beta="10.0"/>
                </Prior>
                <Prior id="BetaPrior" name="distribution" x="@beta">
                    <Beta id="BetaDist.1" name="distr" alpha="1.0" beta="10.0"/>
                </Prior>
            </distribution>
            <distribution id="likelihood" spec="beast.base.inference.CompoundDistribution">
                <!-- PhyloNCO likelihood with error model -->
                <distribution data="@G99_mutations" id="mutationLikelihood" spec="phylonco.beast.evolution.likelihood.TreeLikelihoodWithErrorSlow" tree="@Tree.t:G99">
                    <siteModel id="SiteModel.s:G99" spec="beast.base.evolution.sitemodel.SiteModel">
                        <substModel id="binarySubst.s:G99" spec="phylonco.beast.evolution.substitutionmodel.BinarySubstitutionModel" lambda="@lambda"/>
                    </siteModel>
                    <branchRateModel clock.rate="@clockRate" id="StrictClock.c:G99" spec="beast.base.evolution.branchratemodel.StrictClockModel"/>
                    <errorModel id="errorModel" spec="phylonco.beast.evolution.errormodel.BinaryErrorModel" alpha="@alpha" beta="@beta" datatype="@binaryDataType"/>
                </distribution>
                
                <!-- DIRECTIONAL DIFFUSION LIKELIHOOD -->
                <distribution id="directional3d"
                              spec="beast3d.directional.likelihood.DirectionalDiffusionLikelihood"
                              tree="@Tree.t:G99"
                              trait="@trait.3d">
                    <diffusionModel spec="beast3d.directional.model.DirectionalDiffusionModel">
                        <driftRate idref="drift.rate"/>
                        <diffusionRate idref="diffusion.rate"/>
                        <precisionMatrix idref="precision.3d"/>
                    </diffusionModel>
                </distribution>
            </distribution>
        </distribution>
        
        <!-- Tree operators -->
        <operator id="treeScaler.t:G99" scaleFactor="0.5" spec="ScaleOperator" tree="@Tree.t:G99" weight="3.0"/>
        <operator id="treeRootScaler.t:G99" rootOnly="true" scaleFactor="0.5" spec="ScaleOperator" tree="@Tree.t:G99" weight="3.0"/>
        <operator id="SubtreeSlide.t:G99" spec="SubtreeSlide" tree="@Tree.t:G99" weight="15.0"/>
        <operator id="narrow.t:G99" spec="Exchange" tree="@Tree.t:G99" weight="15.0"/>
        <operator id="wide.t:G99" isNarrow="false" spec="Exchange" tree="@Tree.t:G99" weight="3.0"/>
        <operator id="WilsonBalding.t:G99" spec="WilsonBalding" tree="@Tree.t:G99" weight="3.0"/>
        
        <!-- Parameter operators -->
        <operator id="strictClockUpDownOperator" scaleFactor="0.75" spec="UpDownOperator" weight="3.0">
            <parameter idref="clockRate" name="up"/>
            <tree idref="Tree.t:G99" name="down"/>
        </operator>
        <operator id="StrictClockRateScaler" parameter="@clockRate" scaleFactor="0.75" spec="ScaleOperator" weight="3.0"/>
        <operator id="PopSizeScaler" parameter="@popSize" scaleFactor="0.75" spec="ScaleOperator" weight="3.0"/>
        <operator id="LambdaScaler" parameter="@lambda" scaleFactor="0.75" spec="ScaleOperator" weight="3.0"/>
        
        <!-- Trait operators -->
        <operator id="Trait3DRandomWalk" spec="beast.base.inference.operator.RealRandomWalkOperator"
                  parameter="@trait.3d" windowSize="2.0" weight="20.0"/>
        
        <operator id="Precision3DScaler" spec="beast.base.evolution.operator.ScaleOperator"
                  parameter="@precision.3d" scaleFactor="0.9" weight="10.0"/>
        
        <!-- Directional diffusion operators -->
        <operator id="DriftRateRandomWalk" spec="beast.base.inference.operator.RealRandomWalkOperator"
                  parameter="@drift.rate" windowSize="0.05" weight="20.0"/>
        <operator id="DiffusionRateScaler" spec="beast.base.evolution.operator.ScaleOperator"
                  parameter="@diffusion.rate" scaleFactor="0.9" weight="10.0"/>
        
        <!-- PhyloNCO operators -->
        <operator id="ScaleAlpha" spec="beast.base.evolution.operator.ScaleOperator" parameter="@alpha" scaleFactor="0.75" weight="1.0"/>
        <operator id="ScaleBeta" spec="beast.base.evolution.operator.ScaleOperator" parameter="@beta" scaleFactor="0.75" weight="1.0"/>
        
        <logger id="screenlog" spec="Logger" logEvery="10000">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="directional3d"/>
            <log idref="mutationLikelihood"/>
        </logger>
        
        <logger id="tracelog" spec="Logger" fileName="G99_directional_phylonco_seed42.log" logEvery="2000" sanitiseHeaders="true" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="directional3d"/>
            <log idref="mutationLikelihood"/>
            <log idref="lambda"/>
            <log idref="alpha"/>
            <log idref="beta"/>
            <log idref="precision.3d"/>
            <log idref="drift.rate"/>
            <log idref="diffusion.rate"/>
            <log idref="trait.3d"/>
            <log idref="popSize"/>
            <log idref="clockRate"/>
        </logger>
        
        <logger id="treelog" spec="Logger" fileName="G99_directional_phylonco_seed42.trees" logEvery="2000" mode="tree">
            <log id="TreeWithMetaDataLogger.t:G99" spec="beast.base.evolution.TreeWithMetaDataLogger" tree="@Tree.t:G99">
                <metadata idref="trait.3d"/>
            </log>
        </logger>
        
        <init estimate="false" id="RandomTree.t:G99" initial="@Tree.t:G99" spec="beast.base.evolution.tree.coalescent.RandomTree" taxa="@G99_mutations">
            <populationModel id="ConstantPopulation0.t:G99" spec="ConstantPopulation">
                <parameter id="randomPopSize.t:G99" name="popSize" value="1"/>
            </populationModel>
        </init>
    </run>
</beast>